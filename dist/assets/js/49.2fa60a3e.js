(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{436:function(n,s,e){"use strict";e.r(s);var a=e(54),r=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"springcloud"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#springcloud"}},[n._v("#")]),n._v(" springcloud")]),n._v(" "),e("h2",{attrs:{id:"项目示例"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目示例"}},[n._v("#")]),n._v(" 项目示例")]),n._v(" "),e("p",[e("a",{attrs:{href:"https://gitee.com/DemoMeng/fegin-server-provider",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://gitee.com/DemoMeng/fegin-server-provider"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://gitee.com/DemoMeng/fegin-server-provider-two",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://gitee.com/DemoMeng/fegin-server-provider-two"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://gitee.com/DemoMeng/feign-client-consumer",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://gitee.com/DemoMeng/feign-client-consumer"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://gitee.com/DemoMeng/feign-config-server",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://gitee.com/DemoMeng/feign-config-server"),e("OutboundLink")],1),n._v(" "),e("a",{attrs:{href:"https://gitee.com/DemoMeng/feign-eureka",target:"_blank",rel:"noopener noreferrer"}},[n._v("https://gitee.com/DemoMeng/feign-eureka"),e("OutboundLink")],1)]),n._v(" "),e("ul",[e("li",[e("p",[n._v("两个服务提供方注册到注册中心，feign调用默认会使用轮询负载")])]),n._v(" "),e("li",[e("p",[n._v("这Feign+Eureka总共有三个项目：")])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("feign-client-consumer: 服务消费方\n    1、需要开启Eureka Client配置\n    2、需要开启Feign Client配置\n    3、需要定义本地代理接口，该代理接口需要和服务提供方的controller接口保持保持一致，并且接口url要匹配\n    4、调用服务提供方按照服务注册中心的名字进行调用，不要写ip+端口（这样是不会有RB的效果）\nfeign-server-provider: 服务提供方\n    1、需要开启Eureka Client配置，需要把服务注册到eureka中\nfeign-server-provider-two: 服务提供方2\n    1、需要开启Eureka Client配置，需要把服务注册到eureka中\nfeign-eureka: 服务注册中心\n    1、需要开Eureka Server配置\nfeign-eureka-gateway: 网关\n    1、需要注册到eureka\n    2、配置网关请求过滤路由\n    3、所有请求均请求该网关\nfeign-config-server: 配置中心\n    1、需要注册到eureka\n    2、读取本地配置中心\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("p",[e("a",{attrs:{"data-fancybox":"",title:"111",href:"eureka注册中心.jpg"}},[e("img",{attrs:{src:"eureka%E6%B3%A8%E5%86%8C%E4%B8%AD%E5%BF%83.jpg",alt:"eureka注册中心信息"}})]),n._v(" "),e("a",{attrs:{"data-fancybox":"",title:"111",href:"feign调用成功.jpg"}},[e("img",{attrs:{src:"feign%E8%B0%83%E7%94%A8%E6%88%90%E5%8A%9F.jpg",alt:"调用成功"}})]),n._v(" "),e("a",{attrs:{"data-fancybox":"",title:"111",href:"网关调用成功.jpg"}},[e("img",{attrs:{src:"%E7%BD%91%E5%85%B3%E8%B0%83%E7%94%A8%E6%88%90%E5%8A%9F.jpg",alt:"网关调用成功"}})])]),n._v(" "),e("h2",{attrs:{id:"eureka"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eureka"}},[n._v("#")]),n._v(" Eureka")]),n._v(" "),e("ul",[e("li",[n._v("mavne依赖引入")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("***** springboot版本 *******\n<parent>\n    <groupId>org.springframework.boot</groupId>\n    <artifactId>spring-boot-starter-parent</artifactId>\n    <version>2.3.5.RELEASE</version>\n    <relativePath/> \x3c!-- lookup parent from repository --\x3e\n</parent>\n\n<spring-cloud.version>Hoxton.SR9</spring-cloud.version>\n\n\n\x3c!-- Eureka依赖 --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-eureka-server</artifactId>\n</dependency>\n\n\x3c!-- spring cloud 依赖--\x3e\n<dependencyManagement>\n    <dependencies>\n        <dependency>\n            <groupId>org.springframework.cloud</groupId>\n            <artifactId>spring-cloud-dependencies</artifactId>\n            <version>${spring-cloud.version}</version>\n            <type>pom</type>\n            <scope>import</scope>\n        </dependency>\n    </dependencies>\n</dependencyManagement>\n\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br")])]),e("ul",[e("li",[n._v("springbootapplication开启eureka服务端")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("@SpringBootApplication\n@EnableEurekaServer\npublic class FeignEurekaApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(FeignEurekaApplication.class, args);\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br")])]),e("ul",[e("li",[n._v("application.properties配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("# 设置spring应用命名，可以自定义，非必要\nspring.application.name=eureka-server\n# 设置Eureka Server WEB控制台端口，自定义\nserver.port=8761\n#关闭自我保护\neureka.server.enable-self-preservation=false\n#检测间隔，单位毫秒，默认为一分钟\neureka.server.eviction-interval-timer-in-ms=4000\n#是否将自己注册到Eureka-Server中，默认的为true\neureka.client.registerWithEureka=false\n#是否从Eureka-Server中获取服务注册信息，默认为true\neureka.client.fetchRegistry=false\n#服务注册的地址\neureka.client.serviceUrl.defaultZone=http://localhost:${server.port}/eureka/\n#sentinel控制面板url\nspring.cloud.sentinel.transport.dashboard=localhost:8080\nspring.cloud.sentinel.transport.port=8719\nspring.cloud.sentinel.eager=true\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br")])]),e("h2",{attrs:{id:"gateway"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#gateway"}},[n._v("#")]),n._v(" Gateway")]),n._v(" "),e("ul",[e("li",[n._v("maven引入依赖\nspringBoot版本和eureka-server一致、springcloud版本也是一致")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("\x3c!-- eureka 客户端（服务端或者是服务消费端） --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n</dependency>\n\n\x3c!-- getway网关依赖 --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-gateway</artifactId>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br")])]),e("ul",[e("li",[n._v("application.yml配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("server:\n  port: 5035\n\nspring:\n  application:\n    name: feign-eureka-getway\n\n  cloud:\n    gateway:\n      routes:\n        - id: feign-server-provider-route\n          #单机配置指定域名及端口\n          #uri: http://127.0.0.1:3033\n          #负载配置\n          uri: lb://feign-server-provider\n          predicates:\n            - Path=/feign-server-provider/**\n        - id: feign-client-consumer-route\n          #单机配置指定域名及端口\n          #uri: http://127.0.0.1:3034\n          #负载配置\n          uri: lb://feign-client-consumer\n          predicates:\n            - Path=/feign-client-consumer/**,/feign/client/consumer/**\n      discovery:\n        locator:\n          enabled: true\n    #Sentinel\n    sentinel:\n      transport:\n        dashboard: localhost:8080\n        port: 8719\n      eager: true\n\n\n#指定eureka注册中心地址，其他按照默认配置\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/\n\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br")])]),e("ul",[e("li",[n._v("springbootapplication配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("/**\n *\n *  Parameter 0 of method modifyRequestBodyGatewayFilterFactory in org.springframework.cloud.gateway.config.GatewayAutoConfiguration\n *   required a bean of type 'org.springframework.http.codec.ServerCodecConfigurer' that could not be found.\n *\n *    spring cloud gateway server项目是一个spring boot项目，在启动的时候会去加载它的配置，其中有一个叫做GatewayClassPathWarningAutoConfiguration的配置类中有这么一行代码：\n *     在类路径上找到的Spring MVC，此时它与Spring Cloud网关不兼容。请删除spring-boot-start-web依赖项。\n *     因为spring cloud gateway是基于webflux的，如果非要web支持的话需要导入spring-boot-starter-webflux而不是spring-boot-start-web。\n *\n * @author mqz\n */\n@SpringBootApplication\n@EnableEurekaClient\npublic class FeignEurekaGetwayApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(FeignEurekaGetwayApplication.class, args);\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br")])]),e("h2",{attrs:{id:"springcloudconfig配置中心"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#springcloudconfig配置中心"}},[n._v("#")]),n._v(" SpringCloudConfig配置中心")]),n._v(" "),e("ul",[e("li",[n._v("maven引入依赖: spring-cloud-config-server、eureka-client\nspringBoot版本和eureka-server一致、springcloud版本也是一致")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("\x3c!-- 配置中心==服务端 --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-config-server</artifactId>\n</dependency>\n\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br")])]),e("ul",[e("li",[n._v("application.yml配置：")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("server:\n  port: 2000\n\n#Eureka注册中心配置\nspring:\n  application:\n    name: feign-config-server\n  profiles:\n    active: native\n  #读取本地配置，加载的方式为本地类路径\n  cloud:\n    config:\n      #name: config-server\n      #enabled: false #远程配置关闭\n      server:\n        #health:\n          #enable: false\n        native:\n          search-locations: classpath:config/ # 搜索src/main/resource 下的properties文件夹下的文件\n    #Sentinel\n    sentinel:\n      eager: true\n      transport:\n        port: 8719\n        dashboard: localhost:8080\n\n#  如果不配置 spring.profiles.active=active 报错：\n#  Invalid config server configuration.\n#  Action:\n#  If you are using the git profile, you need to set a Git URI in your configuration.\n#  If you are using a native profile and have spring.cloud.config.server.bootstrap=true,\n#  you need to use a composite configuration.\n\neureka:\n  client:\n    serviceUrl:\n      defaultZone: http://localhost:8761/eureka/\n\n\n\n  #配置配置中读取配置的方式\n  ##  Config Server获取配置支持的方式很多，\n  ##  包括Git仓库(github/gitee等)，任何与JDBC兼容的数据库，\n  ##  Subversion，Hashicorp Vault，Credhub和本地文件系统。\n\n  ####### 1. git配置的方式\n  ####### spring:\n  #######   cloud:\n  #######    config:\n  #######       server:\n  #######        git:\n  #######           uri: https://gitee.com/bugzeroman/spring-cloud-config.git\n\n  ####### 2.本地配置方式包括本地类路径和文件系统两种方式，\n  ####### 要使用本地配置方式，首先设置spring.profiles.active为native，然后spring.cloud.config.server.native.searchLocations指向任何静态的URL，\n\n  #######  2.1 : 本地类路径方式 通过在search-locations中指定classpath下的路径：\n  #######  spring:\n  #######    application:\n  #######      name: config-server\n  #######    profiles:\n  #######      active: native\n  #######    cloud:\n  #######      config:\n  #######        server:\n  #######          native:\n  #######            search-locations: classpath:/config-server/gitee\n\n  #######  2.1 : 本地文件系统方式 通过在search-locations中指定file协议的本地路径：\n  #######  spring:\n  #######    application:\n  #######      name: config-server\n  #######    profiles:\n  #######      active: native\n  #######    cloud:\n  #######      config:\n  #######        server:\n  #######          native:\n  #######            search-locations: file:///D:/spring-cloud-demo/config-server/src/main/resources/config-server/gitee\n  #######  需要注意的是Windows中的绝对路径需要额外的/：\n  #######  file:///${user.home}/config-repo\n  #######  而且额外的/是需要转义的，所有上面有3个/；\n  #######  在Lunix环境下，只需要1个/即可:\n  #######  file:/${user.home}/config-repo\n\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br"),e("span",{staticClass:"line-number"},[n._v("76")]),e("br"),e("span",{staticClass:"line-number"},[n._v("77")]),e("br"),e("span",{staticClass:"line-number"},[n._v("78")]),e("br"),e("span",{staticClass:"line-number"},[n._v("79")]),e("br"),e("span",{staticClass:"line-number"},[n._v("80")]),e("br"),e("span",{staticClass:"line-number"},[n._v("81")]),e("br"),e("span",{staticClass:"line-number"},[n._v("82")]),e("br"),e("span",{staticClass:"line-number"},[n._v("83")]),e("br"),e("span",{staticClass:"line-number"},[n._v("84")]),e("br"),e("span",{staticClass:"line-number"},[n._v("85")]),e("br")])]),e("ul",[e("li",[e("p",[n._v("resource配置文件: 目录位置： redources/config/feign-client-consumer-dev.yml\n需要使用配置中心的配置文件的项目名+环境.yml。比如：feign-client-consumer-dev.yml")])]),n._v(" "),e("li",[e("p",[n._v("springbootApplication配置")])])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("@SpringBootApplication\n@EnableConfigServer\n@EnableEurekaClient\npublic class FeignConfigServerApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(FeignConfigServerApplication.class, args);\n    }\n}\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br")])]),e("p",[n._v("###配置文件名与URL的映射关系")]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("Config Server 中配置文件的 HTTP 资源操作方式如下\n\n/{application}/{profile}[/{label}]\n/{application}-{profile}.yml\n/{label}/{application}-{profile}.yml\n/{application}-{profile}.properties\n/{label}/{application}-{profile}.properties\n\n其中，配置中心的客户端访问配置中心的配置文件规则： feign-client-consumer-dev.yml 其中，feign-client-consumer 是应用名，dev是文件\n{application} 被用于 spring 配置的配置文件名称，在 spring boot 中通常默认为 application；\n{profile} 表示激活的配置文件，通常用于区分开发(dev)/测试(test)/生产环境(prod)；\n{label} 则表示 git 的分支，默认为 master。\n")])])]),e("h3",{attrs:{id:"三种方式实现配置文件读取"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三种方式实现配置文件读取"}},[n._v("#")]),n._v(" 三种方式实现配置文件读取：")]),n._v(" "),e("p",[e("code",[n._v("1.git方式：")])]),n._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[n._v("   a : git仓库创建一个config仓库， https://github.com/DemoMeng/config\n        创建配置文件，文件名称规范为： {application}-{profile}.properties\n        \n   b : 启动类上加上 @EnableConfigServer 注解\n   \n   c : application.yml 配置文件配置：\n   \n       spring:\n         application:\n           name: feign-config-server\n         profiles:\n           active: git #设置使用本地配置(默认是git,可以设置：subversion(SVN)，native(本地))\n         cloud:\n           config:\n             server:\n               #如下是GIT配置\n               git:\n                 uri: https://github.com/DemoMeng/config     # 配置git仓库的地址（最后不需要带/，否则会出现：No custom http config found for URL: XXX）\n                 search-paths: config                             # git仓库地址下的相对搜索地址（可用使用通配符），可以配置多个，用,分割。可以{application}实现按应用查配置\n                 username:                                             # git仓库的账号（公开仓库无需账号信息）\n                 password:                                             # git仓库的密码（公开仓库无需账号信息）\n                 default-label: master                             #git默认分支\n")])])]),e("p",[e("code",[n._v("2.svn方式：")])]),n._v(" "),e("p",[e("code",[n._v("3.本地方式：")]),n._v("\n参考本项目的application.yml配置\n"),e("a",{attrs:{"data-fancybox":"",title:"111",href:"配置中心-配置中心客户端bootstrap配置.jpg"}},[e("img",{attrs:{src:"%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83-%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83%E5%AE%A2%E6%88%B7%E7%AB%AFbootstrap%E9%85%8D%E7%BD%AE.jpg",alt:"直接访问配置中心"}})]),n._v(" "),e("a",{attrs:{"data-fancybox":"",title:"111",href:"配置中心-直接访问配置中查看配置信息.jpg"}},[e("img",{attrs:{src:"%E9%85%8D%E7%BD%AE%E4%B8%AD%E5%BF%83-%E7%9B%B4%E6%8E%A5%E8%AE%BF%E9%97%AE%E9%85%8D%E7%BD%AE%E4%B8%AD%E6%9F%A5%E7%9C%8B%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF.jpg",alt:"直接访问配置中心"}})])]),n._v(" "),e("h3",{attrs:{id:"别的项目拉取配置中心的配置"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#别的项目拉取配置中心的配置"}},[n._v("#")]),n._v(" 别的项目拉取配置中心的配置：")]),n._v(" "),e("ul",[e("li",[n._v("maven依赖配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("\x3c!-- 配置中心依赖 --\x3e\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-config-client</artifactId>\n</dependency>\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br")])]),e("ul",[e("li",[n._v("bootstrap.yml配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v("eureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8761/eureka/\nspring:\n  application:\n    name: feign-client-consumer\n  cloud:\n    config:\n      discovery:\n        enabled: true\n        service-id: feign-config-server\n      name: feign-client-consumer\n      profile: prod\n      #profile: dev\n    #sentinel\n    sentinel:\n      transport:\n        port: 8719\n        dashboard: localhost:8080\n      eager: true\n  profiles:\n    active: dev\nserver:\n  port: 3034\n")])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br")])]),e("ul",[e("li",[n._v("springbootApplication配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('/**\n * @author mqz\n * @EnableFeignClient 开启feign客户端（服务消费方） ，服务提供方不需要配置任何feign的配置\n * @EnableEurekaClient 开启eureka服务客户端（服务端是Eureka server）\n *\n */\n@SpringBootApplication\n@ComponentScan(basePackages = {"com.mqz.feign.client.consumer.**"})\n@EnableFeignClients\n@EnableEurekaClient\npublic class FeignClientConsumerApplication {\n\n    public static void main(String[] args) {\n        SpringApplication.run(FeignClientConsumerApplication.class, args);\n    }\n\n    /**\n     * 针对读取配置中心的属性时候\n     * 当在第一个application.yml下找不到的时候，它就会报错。\n     * 添加之后会忽略暂时在该配置文件里未取到的value，继续寻找下去，该问题就解决了。\n     * @return\n     */\n    @Bean\n    public static PropertySourcesPlaceholderConfigurer placeholderConfigurer() {\n        PropertySourcesPlaceholderConfigurer c = new PropertySourcesPlaceholderConfigurer();\n        c.setIgnoreUnresolvablePlaceholders(true);\n        return c;\n    }\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br")])]),e("ul",[e("li",[n._v("使用配置")])]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('@RefreshScope //实现刷新配置\n@RestController\n@RequestMapping("/feign/client/config")\npublic class ConfigController {\n\n    @Value("${mqz.config.username}")\n    private String username;\n    @Value("${mqz.config.password}")\n    private String password;\n\n    @Value("${consumer.server.welcome}")\n    private String mqz;\n\n    @Value("${mqz}")\n    private String mqz1;\n\n    @GetMapping("/get")\n    public String get(){\n        //return "配置中心读取出来的配置是：username:"+ username+",password:"+password;\n        return "配置中心读取出来的配置是：mqz:"+ mqz1;\n    }\n}\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);