(window.webpackJsonp=window.webpackJsonp||[]).push([[92],{486:function(s,a,n){"use strict";n.r(a);var t=n(54),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,n=s._self._c||a;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"rabbitmq"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmq"}},[s._v("#")]),s._v(" Rabbitmq")]),s._v(" "),n("p",[s._v("Rabbitmqæœ¬èº«æ˜¯åŸºäº Erlangç¼–å†™çš„ï¼ŒErlang è¯­è¨€å¤©ç”Ÿå°±å…·æœ‰åˆ†å¸ƒå¼çš„ç‰¹æ€§ï¼ˆ.erlange.cookieå®ç°é›†ç¾¤å¹¶ä¸”é›†ç¾¤èŠ‚ç‚¹çš„é€šä¿¡ï¼‰")]),s._v(" "),n("h1",{attrs:{id:"rabbitmqé›†ç¾¤å’Œé«˜å¯ç”¨æ–¹æ¡ˆ"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#rabbitmqé›†ç¾¤å’Œé«˜å¯ç”¨æ–¹æ¡ˆ"}},[s._v("#")]),s._v(" RabbitMQé›†ç¾¤å’Œé«˜å¯ç”¨æ–¹æ¡ˆ")]),s._v(" "),n("ul",[n("li",[s._v("æ™®é€šé›†ç¾¤æ¨¡å¼")]),s._v(" "),n("li",[s._v("é•œåƒå¤åˆ¶æ¨¡å¼")])]),s._v(" "),n("h2",{attrs:{id:"æ™®é€šé›†ç¾¤æ¨¡å¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ™®é€šé›†ç¾¤æ¨¡å¼"}},[s._v("#")]),s._v(" æ™®é€šé›†ç¾¤æ¨¡å¼")]),s._v(" "),n("p",[s._v("æ¯å°æœºå™¨ä¸­éƒ¨ç½²ä¸€ä¸ªRabbitMQæœåŠ¡èŠ‚ç‚¹ï¼Œè¿›è€Œç”±å¤šä¸ªæœºå™¨ç»„æˆä¸€ä¸ªRabbitMQé›†ç¾¤\næ™®é€šæ¨¡å¼ä¸­ï¼Œæ¶ˆæ¯æ•°æ®æ˜¯ä¸ä¼šåŒæ­¥çš„ï¼Œå› ä¸ºå®ƒä»¬ä¹‹é—´åªåŒæ­¥ å…ƒæ•°æ®ï¼Œå…ƒæ•°æ®ä¸­ä¸åŒ…å«æ¶ˆæ¯æ•°æ®ã€‚\nè‹¥ å®¢æˆ·ç«¯è¿æ¥åˆ° AèŠ‚ç‚¹ï¼Œä½†æ˜¯æ¶ˆæ¯åˆåœ¨ BèŠ‚ç‚¹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæ™®é€šé›†ç¾¤æ¨¡å¼æ— æ³•å®ç°æ¶ˆæ¯åœ¨èŠ‚ç‚¹ä¸­çš„è½¬å‘ï¼Œ\næ‰€ä»¥æ™®é€šé›†ç¾¤æ¨¡å¼æ— æ³•å®ç°é«˜å¯ç”¨ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥ä½¿ç”¨é•œåƒå¤åˆ¶æ¨¡å¼å®ç°è¿™ç§éœ€æ±‚ã€‚")]),s._v(" "),n("p",[s._v("æµç¨‹å›¾\n"),n("a",{attrs:{"data-fancybox":"",title:"111",href:"æ™®é€šé›†ç¾¤æ¨¡å¼.png"}},[n("img",{attrs:{src:"%E6%99%AE%E9%80%9A%E9%9B%86%E7%BE%A4%E6%A8%A1%E5%BC%8F.png",alt:"img.png"}})])]),s._v(" "),n("p",[s._v("å…ƒæ•°æ®åŒ…å«ï¼šï¼ˆä¸åŒ…å«æ¶ˆæ¯ï¼‰\né˜Ÿåˆ—å…ƒæ•°æ®ï¼š é˜Ÿåˆ—åç§°ã€å±æ€§ç­‰\näº¤æ¢å™¨æ•°æ®ï¼š äº¤æ¢å™¨åç§°ã€å±æ€§\nç»‘å®šå…ƒæ•°æ®ï¼š äº¤æ¢å™¨ç»‘å®šé˜Ÿåˆ—æ•°æ®ã€äº¤æ¢å™¨å’Œäº¤æ¢å™¨ç»‘å®šæ•°æ®\nvhostå…ƒæ•°æ®ï¼š vhostå†…çš„é˜Ÿåˆ—ã€å’Œäº¤æ¢å™¨ç»‘å®šçš„æ•°æ®ã€å‘½åç©ºé—´ã€å®‰å…¨å±æ€§ä¹‹é—´çš„ç»‘å®šå…³ç³»æ•°æ®")]),s._v(" "),n("h2",{attrs:{id:"é•œåƒå¤åˆ¶æ¨¡å¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é•œåƒå¤åˆ¶æ¨¡å¼"}},[s._v("#")]),s._v(" é•œåƒå¤åˆ¶æ¨¡å¼")]),s._v(" "),n("p",[s._v("é•œåƒå¤åˆ¶æ¨¡å¼æ˜¯åœ¨æ™®é€šé›†ç¾¤æ¨¡å¼åŸºç¡€ä¸Šï¼Œé€šè¿‡ policy æ¨¡å—æ¥å®ç°ï¼Œä½¿ç”¨é•œåƒå¤åˆ¶æ¨¡å¼å¯ä»¥å®ç°RabbitMQçš„é«˜å¯ç”¨æ–¹æ¡ˆ\næµç¨‹å›¾\n"),n("a",{attrs:{"data-fancybox":"",title:"111",href:"é•œåƒå¤åˆ¶æ¨¡å¼.png"}},[n("img",{attrs:{src:"%E9%95%9C%E5%83%8F%E5%A4%8D%E5%88%B6%E6%A8%A1%E5%BC%8F.png",alt:"img.png"}})])]),s._v(" "),n("p",[s._v("é•œåƒå¤åˆ¶æ¨¡å¼ç›¸æ¯”äºæ™®é€šé›†ç¾¤æ¨¡å¼ï¼Œä¼šå ç”¨æ¯”è¾ƒå¤šçš„å¸¦å®½ï¼Œå› ä¸ºéœ€è¦å®ç°ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹çš„æ•°æ®å¤åˆ¶ï¼Œæ‰€ä»¥é•œåƒå¤åˆ¶æ¨¡å¼ååé‡ä¼šç¨é€Šæ™®é€šæ¨¡å¼ï¼Œ\nä½†æ˜¯æ™®é€šæ¨¡å¼ä¸èƒ½å®ç°é«˜å¯ç”¨ï¼ŒæŸä¸ªèŠ‚ç‚¹æŒ‚æ‰ä¹‹ååï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸Šçš„æ¶ˆæ¯æ— æ³•è¢«æ¶ˆè´¹ï¼Œéœ€è¦ç­‰å¾…èŠ‚ç‚¹å¯åŠ¨åæ‰èƒ½è¢«æ¶ˆè´¹")]),s._v(" "),n("h2",{attrs:{id:"èŠ‚ç‚¹ç±»å‹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#èŠ‚ç‚¹ç±»å‹"}},[s._v("#")]),s._v(" èŠ‚ç‚¹ç±»å‹")]),s._v(" "),n("p",[s._v("ramï¼šå†…å­˜èŠ‚ç‚¹ å…ƒæ•°æ®å­˜åœ¨å†…å­˜ä¸­ã€‚å¦‚æœæ¶ˆæ¯æŒä¹…åŒ–ä¼šå­˜æ”¾åœ¨ç£ç›˜ä¸­ï¼Œå› ä¸ºå†…å­˜èŠ‚ç‚¹çš„è¯»å–é€Ÿåº¦å—ï¼Œä¸€èˆ¬å®¢æˆ·ç«¯ä¼šè¿æ¥å†…å­˜èŠ‚ç‚¹\ndiscï¼šç£ç›˜èŠ‚ç‚¹ é»˜è®¤èŠ‚ç‚¹ç±»å‹ï¼Œéœ€è¦ä¿è¯è‡³å°‘ä¸€ä¸ªç£ç›˜èŠ‚ç‚¹ï¼Œå¦åˆ™ä¸€æ—¦å®•æœºï¼Œåˆ™æ— æ³•æ¢å¤æ•°æ®ï¼Œä»è€Œæ— æ³•è¾¾åˆ°é«˜å¯ç”¨ï¼")]),s._v(" "),n("h2",{attrs:{id:"æ™®é€šé›†ç¾¤æ¨¡å¼æ­å»ºæ­¥éª¤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#æ™®é€šé›†ç¾¤æ¨¡å¼æ­å»ºæ­¥éª¤"}},[s._v("#")]),s._v(" æ™®é€šé›†ç¾¤æ¨¡å¼æ­å»ºæ­¥éª¤")]),s._v(" "),n("ul",[n("li",[s._v("3å°centos7æœåŠ¡å™¨ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("192.168.2.9\n192.168.2.11\n192.168.2.7\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("ä¿®æ”¹hostæ–‡ä»¶")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("192.168.2.9 rabbit_host11\n192.168.2.11 rabbit_host22\n192.168.2.7 rabbit_host33\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[s._v("æˆ–è€…å•ç‹¬è®¾ç½®æ¯å°æœºå™¨çš„ï¼š")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("hostnamectl set-hostname rabbit_host11\nhostnamectl set-hostname rabbit_host22\nhostnamectl set-hostname rabbit_host33\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("ul",[n("li",[n("p",[s._v("docker-compose å®‰è£…rabbitmqï¼Œå‚è€ƒ yml é…ç½®æ–‡ä»¶ã€‚å…ˆåå¯åŠ¨ rabbitmq1 ã€ rabbitmq2 ã€ rabbitmq3")])]),s._v(" "),n("li",[n("p",[s._v("ç»Ÿä¸€ä¸‰ä¸ªrabbitmqçš„ /var/lib/rabbitmq/.erlang.cookie ï¼ˆä¹Ÿå¯èƒ½æ˜¯åœ¨ $HOME/.erlang.cookie ç›®å½•ï¼‰ æ–‡ä»¶ï¼Œæ³¨æ„å®ƒæ˜¯ä¸€ä¸ªéšè—æ–‡ä»¶ï¼Œå°±åƒæˆ‘ç”µè„‘é‡Œåˆéšè—çš„ .avi æ–‡ä»¶ä¸€æ ·ğŸ¶\nRabbitMQ çš„é›†ç¾¤æ˜¯ä¾èµ– erlang é›†ç¾¤ï¼Œè€Œ erlang é›†ç¾¤æ˜¯é€šè¿‡è¿™ä¸ª cookie è¿›è¡Œé€šä¿¡è®¤è¯\nå°†rabbitmq2 ã€ rabbitmq3 çš„ .erlang.cookieæ–‡ä»¶å†…å®¹ä»¥ rabbitmq1çš„ä¸ºä¸»ï¼Œæ‹·è´æ—¶éœ€è¦åœæ­¢rabbitmqå®ä¾‹\næ³¨æ„æƒé™ ï¼š chmod 600 /var/lib/rabbitmq/.erlang.cookie ï¼Œå¦åˆ™åŠ å…¥é›†ç¾¤ä¼šæŠ¥é”™\n"),n("a",{attrs:{"data-fancybox":"",title:"111",href:"rabbitmqå¼€å¯æ’ä»¶.png"}},[n("img",{attrs:{src:"erlang.cookie%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90.png",alt:"img.png"}})]),s._v("\néšåé‡å¯rabbitmqï¼š docker restart rabbitmq1 \\ rabbitmq2 \\ rabbitmq3")])]),s._v(" "),n("li",[n("p",[s._v("ä¸»èŠ‚ç‚¹æ‰§è¡Œï¼šéœ€è¦æ¸…ç©ºä¹‹å‰å•æœºä¿¡æ¯ï¼Œdockeråˆ™æ¸…ç©ºæŒ‚è½½çš„é…ç½®æ–‡ä»¶\nrabbitmqctl stop_app\nrabbitmqctl reset\nrabbitmqctl start_app")])]),s._v(" "),n("li",[n("p",[s._v("ä»èŠ‚ç‚¹ï¼š æ‰§è¡Œå‰éœ€è¦åœæ­¢è¯¥ rabbitmq å³ rabbitmqctl stop_app")])])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("rabbitmqctl [-n nodename] join_cluster {cluster_node} [â€”ram]\nrabbitmqctl stop_app\nrabbitmqctl reset å¦‚æœèŠ‚ç‚¹ç±»å‹ä¸º discçš„æ—¶å€™éœ€è¦æ‰§è¡Œ\nrabbitmqctl join_cluster --ram rabbit@rabbit_host11 æˆ–è€… rabbitmqctl join_cluster --disc rabbit@rabbit_host11\nrabbitmqctl start_app\n\n\nå¦‚æœèŠ‚ç‚¹ä»¥ç£ç›˜èŠ‚ç‚¹çš„å½¢å¼åŠ å…¥ï¼Œåˆ™éœ€è¦å…ˆä½¿ç”¨ rabbitmqctl reset å‘½ä»¤è¿›è¡Œé‡ç½®ï¼Œç„¶åæ‰èƒ½åŠ å…¥ç°æœ‰ç¾¤é›†ï¼Œé‡ç½®èŠ‚ç‚¹ä¼šåˆ é™¤è¯¥èŠ‚ç‚¹ä¸Šå­˜åœ¨çš„æ‰€æœ‰çš„å†å²èµ„æºå’Œæ•°æ®ã€‚\né‡‡ç”¨å†…å­˜èŠ‚ç‚¹çš„å½¢å¼åŠ å…¥æ—¶å¯ä»¥ç•¥è¿‡ reset è¿™ä¸€æ­¥ï¼Œå› ä¸ºå†…å­˜ä¸Šçš„æ•°æ®æœ¬èº«å°±ä¸æ˜¯æŒä¹…åŒ–çš„\n--ram è¡¨ç¤ºè¿™æ˜¯ä¸€ä¸ªå†…å­˜èŠ‚ç‚¹: æ‰€æœ‰æ•°æ®éƒ½å­˜åœ¨å†…å­˜ä¸­\n--discè¡¨ç¤ºç£ç›˜èŠ‚ç‚¹ï¼ˆé»˜è®¤ä¹Ÿæ˜¯ç£ç›˜èŠ‚ç‚¹ï¼‰ï¼šæ‰€æœ‰æ•°æ®éƒ½å­˜åœ¨ç£ç›˜ä¸­\n-n nodenameï¼š æŒ‡å®šéœ€è¦æ“ä½œçš„ç›®æ ‡èŠ‚ç‚¹\ncluster_nodeï¼šéœ€è¦åŠ å…¥çš„é›†ç¾¤èŠ‚ç‚¹å\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[n("a",{attrs:{"data-fancybox":"",title:"111",href:"rabbitmqç®¡ç†ç•Œé¢.png"}},[n("img",{attrs:{src:"rabbitmq%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2.png",alt:"img.png"}})])]),s._v(" "),n("h2",{attrs:{id:"ä¸»èŠ‚ç‚¹æ‰§è¡Œ-æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸»èŠ‚ç‚¹æ‰§è¡Œ-æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€"}},[s._v("#")]),s._v(" ä¸»èŠ‚ç‚¹æ‰§è¡Œ - æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€")]),s._v(" "),n("p",[s._v("rabbitmqctl status")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("\nStatus of node rabbit@rabbit_host11 ...\nRuntime\n\nOS PID: 19\nOS: Linux\nUptime (seconds): 3319\nIs under maintenance?: false\nRabbitMQ version: 3.10.1\nNode name: rabbit@rabbit_host11\nErlang configuration: Erlang/OTP 24 [erts-12.3.2] [source] [64-bit] [smp:2:2] [ds:2:2:10] [async-threads:1] [jit]\nErlang processes: 444 used, 1048576 limit\nScheduler run queue: 1\nCluster heartbeat timeout (net_ticktime): 60\n\nPlugins\n\nEnabled plugin file: /etc/rabbitmq/enabled_plugins\nEnabled plugins:\n\n * rabbitmq_delayed_message_exchange\n * rabbitmq_prometheus\n * prometheus\n * accept\n * rabbitmq_management\n * amqp_client\n * rabbitmq_web_dispatch\n * cowboy\n * cowlib\n * rabbitmq_management_agent\n\nData directory\n\nNode data directory: /var/lib/rabbitmq/mnesia/rabbit@rabbit_host11\nRaft data directory: /var/lib/rabbitmq/mnesia/rabbit@rabbit_host11/quorum/rabbit@rabbit_host11\n\nConfig files\n\n * /etc/rabbitmq/conf.d/10-defaults.conf\n\nLog file(s)\n\n * /var/log/rabbitmq/rabbit@rabbit_host11_upgrade.log\n * <stdout>\n\nAlarms\n\n(none)\n\nMemory\n\nTotal memory used: 0.1404 gb\nCalculation strategy: rss\nMemory high watermark setting: 0.4 of available memory, computed to: 3.2409 gb\n\nreserved_unallocated: 0.0678 gb (48.27 %)\ncode: 0.0357 gb (25.39 %)\nother_system: 0.0252 gb (17.93 %)\nother_proc: 0.0189 gb (13.43 %)\nother_ets: 0.0033 gb (2.37 %)\nplugins: 0.0032 gb (2.28 %)\natom: 0.0014 gb (1.02 %)\nmgmt_db: 0.0011 gb (0.8 %)\nbinary: 9.0e-4 gb (0.64 %)\nconnection_other: 4.0e-4 gb (0.25 %)\nmetrics: 3.0e-4 gb (0.19 %)\nqueue_procs: 2.0e-4 gb (0.11 %)\nmnesia: 1.0e-4 gb (0.1 %)\nconnection_readers: 1.0e-4 gb (0.07 %)\nmsg_index: 0.0 gb (0.02 %)\nconnection_channels: 0.0 gb (0.02 %)\nquorum_ets: 0.0 gb (0.02 %)\nconnection_writers: 0.0 gb (0.01 %)\nquorum_queue_dlx_procs: 0.0 gb (0.0 %)\nstream_queue_procs: 0.0 gb (0.0 %)\nstream_queue_replica_reader_procs: 0.0 gb (0.0 %)\nallocated_unused: 0.0 gb (0.0 %)\nqueue_slave_procs: 0.0 gb (0.0 %)\nquorum_queue_procs: 0.0 gb (0.0 %)\nstream_queue_coordinator_procs: 0.0 gb (0.0 %)\n\nFile Descriptors\n\nTotal: 5, limit: 1048479\nSockets: 2, limit: 943629\n\nFree Disk Space\n\nLow free disk space watermark: 0.05 gb\nFree disk space: 5.5612 gb\n\nTotals\n\nConnection count: 2\nQueue count: 6\nVirtual host count: 1\n\nListeners\n\nInterface: [::], port: 15672, protocol: http, purpose: HTTP API\nInterface: [::], port: 15692, protocol: http/prometheus, purpose: Prometheus exporter API over HTTP\nInterface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\nInterface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br"),n("span",{staticClass:"line-number"},[s._v("96")]),n("br"),n("span",{staticClass:"line-number"},[s._v("97")]),n("br"),n("span",{staticClass:"line-number"},[s._v("98")]),n("br"),n("span",{staticClass:"line-number"},[s._v("99")]),n("br"),n("span",{staticClass:"line-number"},[s._v("100")]),n("br"),n("span",{staticClass:"line-number"},[s._v("101")]),n("br"),n("span",{staticClass:"line-number"},[s._v("102")]),n("br"),n("span",{staticClass:"line-number"},[s._v("103")]),n("br"),n("span",{staticClass:"line-number"},[s._v("104")]),n("br")])]),n("h2",{attrs:{id:"ä¸»èŠ‚ç‚¹æ‰§è¡Œ-æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#ä¸»èŠ‚ç‚¹æ‰§è¡Œ-æŸ¥çœ‹é›†ç¾¤çŠ¶æ€"}},[s._v("#")]),s._v(" ä¸»èŠ‚ç‚¹æ‰§è¡Œ - æŸ¥çœ‹é›†ç¾¤çŠ¶æ€")]),s._v(" "),n("p",[s._v("rabbitmqctl cluster_status")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("root@rabbit_host11:/# rabbitmqctl cluster_status\nCluster status of node rabbit@rabbit_host11 ...\nBasics\n\nCluster name: rabbit@rabbit_host11\n\nDisk Nodes\n\nrabbit@rabbit_host11\nrabbit@rabbit_host22\n\nRunning Nodes\n\nrabbit@rabbit_host11\nrabbit@rabbit_host22\n\nVersions\n\nrabbit@rabbit_host11: RabbitMQ 3.10.1 on Erlang 24.3.4\nrabbit@rabbit_host22: RabbitMQ 3.10.1 on Erlang 24.3.4\n\nMaintenance status\n\nNode: rabbit@rabbit_host11, status: not under maintenance\nNode: rabbit@rabbit_host22, status: not under maintenance\n\nAlarms\n\n(none)\n\nNetwork Partitions\n\n(none)\n\nListeners\n\nNode: rabbit@rabbit_host11, interface: [::], port: 15672, protocol: http, purpose: HTTP API\nNode: rabbit@rabbit_host11, interface: [::], port: 15692, protocol: http/prometheus, purpose: Prometheus exporter API over HTTP\nNode: rabbit@rabbit_host11, interface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\nNode: rabbit@rabbit_host11, interface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\nNode: rabbit@rabbit_host22, interface: [::], port: 15672, protocol: http, purpose: HTTP API\nNode: rabbit@rabbit_host22, interface: [::], port: 15692, protocol: http/prometheus, purpose: Prometheus exporter API over HTTP\nNode: rabbit@rabbit_host22, interface: [::], port: 25672, protocol: clustering, purpose: inter-node and CLI tool communication\nNode: rabbit@rabbit_host22, interface: [::], port: 5672, protocol: amqp, purpose: AMQP 0-9-1 and AMQP 1.0\n\nFeature flags\n\nFlag: classic_mirrored_queue_version, state: enabled\nFlag: drop_unroutable_metric, state: enabled\nFlag: empty_basic_get_metric, state: enabled\nFlag: implicit_default_bindings, state: enabled\nFlag: maintenance_mode_status, state: enabled\nFlag: quorum_queue, state: enabled\nFlag: stream_queue, state: enabled\nFlag: user_limits, state: enabled\nFlag: virtual_host_metadata, state: enabled\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br")])]),n("p",[n("a",{attrs:{"data-fancybox":"",title:"111",href:"æŸ¥çœ‹å·²å®‰è£…çš„æ’ä»¶.png"}},[n("img",{attrs:{src:"%E6%9F%A5%E7%9C%8B%E5%B7%B2%E5%AE%89%E8%A3%85%E7%9A%84%E6%8F%92%E4%BB%B6.png",alt:"æŸ¥çœ‹å·²å®‰è£…çš„æ’ä»¶.png"}})])]),s._v(" "),n("h2",{attrs:{id:"é•œåƒå¤åˆ¶æ¨¡å¼-é«˜å¯ç”¨æ¨¡å¼"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é•œåƒå¤åˆ¶æ¨¡å¼-é«˜å¯ç”¨æ¨¡å¼"}},[s._v("#")]),s._v(" é•œåƒå¤åˆ¶æ¨¡å¼-é«˜å¯ç”¨æ¨¡å¼")]),s._v(" "),n("ul",[n("li",[s._v("é•œåƒé˜Ÿåˆ—æ¨¡å¼ç›¸æ¯”è¾ƒæ™®é€šæ¨¡å¼ï¼Œé•œåƒæ¨¡å¼ä¼šå ç”¨æ›´å¤šçš„å¸¦å®½æ¥è¿›è¡ŒåŒæ­¥ï¼Œæ‰€ä»¥é•œåƒé˜Ÿåˆ—çš„ååé‡ä¼šä½äºæ™®é€šæ¨¡å¼ã€‚\nä½†æ™®é€šæ¨¡å¼ä¸èƒ½å®ç°é«˜å¯ç”¨ï¼ŒæŸä¸ªèŠ‚ç‚¹æŒ‚äº†åï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¸Šçš„æ¶ˆæ¯å°†æ— æ³•è¢«æ¶ˆè´¹ï¼Œéœ€è¦ç­‰å¾…èŠ‚ç‚¹å¯åŠ¨åæ‰èƒ½è¢«æ¶ˆè´¹ã€‚")]),s._v(" "),n("li",[s._v("éœ€è¦ä½¿ç”¨ policy æ¨¡å—ï¼Œpolicyä¸»è¦ç”¨äºè®¾ç½® Exchange æˆ–è€… Queue çš„æ•°æ®éœ€è¦å¦‚ä½•å¤åˆ¶ï¼ŒåŒæ­¥åˆ°å…¶ä»–èŠ‚ç‚¹")]),s._v(" "),n("li",[s._v('è®¾ç½®ä¸»èŠ‚ç‚¹åŒæ­¥ä»èŠ‚ç‚¹ äº¤æ¢æœºã€é˜Ÿåˆ—çš„ç­–ç•¥è§„åˆ™\n1.å‘½ä»¤ï¼š rabbitmqctl set_policy -p / ha "^" \'{"ha-mode":"all"}\''),n("br"),s._v('\nrabbitmqctl -n rabbit1 set_policy ha-all "^" \'{"ha-mode":"all"}\'')])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('ha ï¼š ç­–ç•¥åç§°\n^  ï¼š åŒ¹é…è§„åˆ™ï¼Œ ^ åˆ™è¡¨ç¤ºåŒ¹é…æ‰€æœ‰ ^Q åˆ™åŒ¹é…åå­—\n{"ha-mode":"exactly","ha-params":2} ï¼š æ˜¯ç­–ç•¥çš„å®šä¹‰ï¼Œ ha-modeå’Œha-paramsç»„åˆä½¿ç”¨\n\n            ha-mode   ha-params   è¯´æ˜ \n             all      ï¼ˆemptyï¼‰   é˜Ÿåˆ—é•œåƒåˆ°é›†ç¾¤æ‰€æœ‰èŠ‚ç‚¹\n             exactly   intå€¼      é˜Ÿåˆ—é•œåƒåˆ°é›†ç¾¤å†…æŒ‡å®šæ•°é‡èŠ‚ç‚¹ï¼Œè‹¥é›†ç¾¤å†…èŠ‚ç‚¹æ•°å°‘äºè¯¥å€¼ï¼Œé˜Ÿåˆ—å°†ä¼šé•œåƒåˆ°æ‰€æœ‰èŠ‚ç‚¹ï¼Œè‹¥å¤§äºè¯¥å€¼ï¼Œè€Œä¸”ä¸€ä¸ªåŒ…å«é•œåƒçš„èŠ‚ç‚¹åœæ­¢ï¼Œåˆ™æ–°çš„é•œåƒä¸ä¼šåœ¨å…¶ä»–èŠ‚ç‚¹åˆ›å»º\n             nodes     èŠ‚ç‚¹åç§°    é˜Ÿåˆ—é•œåƒåˆ°æŒ‡å®šèŠ‚ç‚¹ï¼ŒæŒ‡å®šèŠ‚ç‚¹ä¸åœ¨é›†ç¾¤ä¸­ä¸ä¼šæŠ¥é”™ï¼Œå½“é˜Ÿåˆ—ç”³æ˜æ—¶å€™ï¼Œå¦‚æœæŒ‡å®šèŠ‚ç‚¹ä¸åœ¨çº¿ï¼Œåˆ™é˜Ÿåˆ—ä¼šè¢«åˆ›å»ºåœ¨å®¢æˆ·ç«¯è¿æ¥çš„èŠ‚ç‚¹ä¸Š\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("ul",[n("li",[s._v('è®¾ç½®ç­–ç•¥åŒ¹é…æ‰€æœ‰åç§°æ˜¯ampå¼€å¤´çš„é˜Ÿåˆ—éƒ½å­˜å‚¨åœ¨2ä¸ªèŠ‚ç‚¹ä¸Šçš„å‘½ä»¤å¦‚ä¸‹\nrabbitmqctl set_policy -p / ha "^amp*" \'{"ha-mode":"exactly","ha-params":2}\'')]),s._v(" "),n("li",[s._v('è®¾ç½®ç­–ç•¥åŒ¹é…æ‰€æœ‰åç§°çš„é˜Ÿåˆ—éƒ½è¿›è¡Œé«˜å¯ç”¨é…ç½®\nrabbitmqctl set_policy -p / ha "^" \'{"ha-mode":"all","ha-sync-mode":"automatic"}\'')]),s._v(" "),n("li",[s._v("æŸ¥è¯¢ç­–ç•¥ #æŸ¥çœ‹vhostä¸‹çš„æ‰€æœ‰çš„ç­–ç•¥ï¼ˆpolicies ï¼‰\nrabbitmqctl list_policies -p /")])]),s._v(" "),n("p",[s._v("2.webç®¡ç†ç•Œé¢æ–¹å¼ï¼š"),n("br"),s._v(" "),n("a",{attrs:{"data-fancybox":"",title:"111",href:"é•œåƒå¤æ¨¡å¼é…ç½®policy.png"}},[n("img",{attrs:{src:"%E9%95%9C%E5%83%8F%E5%A4%8D%E6%A8%A1%E5%BC%8F%E9%85%8D%E7%BD%AEpolicy.png",alt:"img.png"}})])]),s._v(" "),n("h2",{attrs:{id:"é›†ç¾¤çš„å…³é—­å’Œé‡å¯"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#é›†ç¾¤çš„å…³é—­å’Œé‡å¯"}},[s._v("#")]),s._v(" é›†ç¾¤çš„å…³é—­å’Œé‡å¯")]),s._v(" "),n("p",[s._v("æ— æ³•ä¸€æ¡å‘½ä»¤å…³é—­æˆ–é‡å¯é›†ç¾¤ï¼Œéœ€è¦ä¸€ä¸€è¿›è¡Œæ“ä½œï¼\nå‡è®¾åœ¨ä¸€ä¸ªä¸‰èŠ‚ç‚¹çš„é›†ç¾¤å½“ä¸­ï¼Œå…³é—­çš„é¡ºåºä¸º node1ï¼Œnode2ï¼Œnode3ï¼Œå¦‚æœ node1 å› ä¸ºæ•…éšœæš‚æ—¶æ²¡æ³•æ¢å¤ï¼Œæ­¤æ—¶ node2 å’Œ node3 å°±æ— æ³•å¯åŠ¨ã€‚æƒ³è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å…ˆå°† node1 èŠ‚ç‚¹è¿›è¡Œå‰”é™¤ï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š\nrabbitmqctl forget_cluster_node rabbit@node1 --offline  # --offline ï¼š å…è®¸èŠ‚ç‚¹åœ¨è‡ªå·±æ²¡æœ‰å¯åŠ¨çš„æƒ…å†µä¸‹å¯ä»¥å°†å…¶ä»–èŠ‚ç‚¹åˆ é™¤")]),s._v(" "),n("p",[s._v("rabbitmqctl forget_cluster_node rabbit@node1 ï¼š å¼ºåˆ¶åˆ é™¤èŠ‚ç‚¹å‡ºé›†ç¾¤")]),s._v(" "),n("ul",[n("li",[s._v("è§£é™¤é›†ç¾¤ ï¼ˆä¸»ã€ä»ï¼‰\nrabbitmqctl stop_app\nrabbitmqctl reset\nrabbitmqctl start_app")])]),s._v(" "),n("h1",{attrs:{id:"åŸºäº-haproxy-keepalived-é«˜å¯ç”¨é›†ç¾¤"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#åŸºäº-haproxy-keepalived-é«˜å¯ç”¨é›†ç¾¤"}},[s._v("#")]),s._v(" åŸºäº HAProxy + Keepalived é«˜å¯ç”¨é›†ç¾¤")])])}),[],!1,null,null,null);a.default=e.exports}}]);