(window.webpackJsonp=window.webpackJsonp||[]).push([[80],{468:function(n,s,e){"use strict";e.r(s);var a=e(54),t=Object(a.a)({},(function(){var n=this,s=n.$createElement,e=n._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[e("h1",{attrs:{id:"redis-sentinel-配置文件"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#redis-sentinel-配置文件"}},[n._v("#")]),n._v(" redis-sentinel 配置文件")]),n._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[n._v('# 安全策略，选择如下任意一个即可\n# bind 127.0.0.1 192.168.1.1\n# protected-mode no\n\nport 26379\n\n#默认情况下，Redis Sentinel 不作为守护进程运行。如果需要，请使用“是”。注意Redis在守护进程时会在varrunredis-sentinel.pid中写入一个pid文件。\ndaemonize no\n#指定守护进程的文件位置\npidfile /var/run/redis-sentinel.pid\n#指定日志文件名。此外，空字符串可用于强制 Sentinel 登录标准输出。请注意，如果您使用标准输出进行日志记录但守护进程，日志将被发送到 devnull\nlogfile ""\n# sentinel announce-ip 1.2.3.4\n\n# dir <working-directory>\n# sentinel工作目录\ndir /tmp\n\n# sentinel monitor <master-name> <ip> <redis-port> <quorum>\n# 告诉 Sentinel 监视这个 master，并且只有在至少 <quorum> 哨兵同意时才考虑它处于 O_DOWN（客观关闭）状态。\n# 只需要配置主节点，当slave升级为master后，该配置文件会被重写\n# 支持域名配置\n# 监控主要节点，1代表有1台sentinel监控redi为有问题，那就执行故障转移\nsentinel monitor mymaster 192.168.2.9 6379 1\n\n# sentinel auth-pass <master-name> <password>\n# master节点的密码，注意master和slave密码需要设置一致！！\nsentinel auth-pass mymaster mengqizhang\n\n# acl控制，6.0之后新增\n# sentinel auth-user <master-name> <username>\n#     user sentinel-user >somepassword +client +subscribe +publish \\\n#                        +ping +info +multi +slaveof +config +client +exec on\n\n# sentinel ping从节点无响应的时间，无响应则认为故障，S_DOWN，默认为30s秒\n# sentinel down-after-milliseconds <master-name> <milliseconds>\nsentinel down-after-milliseconds mymaster 30000\n\n# 配置sentinel的密码，建议所有的sentinel密码配置为一致\n# requirepass <password>\n\n# 在故障转移期间，我们可以重新配置多少副本以同时指向新副本。如果您使用副本来提供查询服务，请使用较小的数字，以避免在与主服务器执行同步时几乎同时无法访问所有副本。\n# sentinel parallel-syncs <master-name> <numreplicas>\nsentinel parallel-syncs mymaster 1\n\n# 设置故障转移超时时间，默认3分钟\n# sentinel failover-timeout <master-name> <milliseconds>\n# Specifies the failover timeout in milliseconds. It is used in many ways:\n# - 在给定的 Sentinel 已经针对同一个主服务器尝试了先前的故障转移之后，重新启动故障转移所需的时间是故障转移超时的两倍。\n# - 根据 Sentinel 当前配置将副本复制到错误的 master 并强制使用正确的 master 进行复制所需的时间正是故障转移超时（从 Sentinel 检测到错误配置的那一刻开始计算）。\n# - 取消已在进行中但未产生任何配置更改的故障转移所需的时间（SLAVEOF NO ONE 尚未被提升的副本确认）。\n# - 正在进行的故障转移等待所有副本重新配置为新主副本的最长时间。然而，即使在这段时间之后，Sentinels 仍然会重新配置副本，但不会按照指定的精确并行同步进程进行配置。\nsentinel failover-timeout mymaster 180000\n\n\n# sentinel执行故障转移后，可以执行指定的脚本，用于通知开发人员或者记录故障转移记录等！！脚本最长执行时间为60秒\n# 如果脚本以“1”退出，则稍后重试执行（最多当前设置为 10 的最大次数）。\n# 如果脚本以“2”（或更高的值）退出，则不会重试脚本执行。\n# 执行指定的通知脚本\n# sentinel notification-script <master-name> <script-path>\n# sentinel notification-script mymaster /var/redis/notify.sh\n\n# 客户端重新配置脚本\n# sentinel client-reconfig-script <master-name> <script-path>\n#\n# 当主服务器因故障转移而更改时，可以调用脚本以执行特定于应用程序的任务，以通知客户端配置已更改且主服务器位于不同的地址。\n# 以下参数传递给脚本\n# <master-name> <role> <state> <from-ip> <from-port> <to-ip> <to-port>\n# <state> is currently always "failover"\n# <role> is either "leader" or "observer"\n# sentinel client-reconfig-script mymaster /var/redis/reconfig.sh\n\n# 默认情况下，SENTINEL SET 将无法在运行时更改通知脚本和客户端重新配置脚本。这避免了客户端可以将脚本设置为任何内容并触发故障转移以使程序执行的微不足道的安全问题。\nsentinel deny-scripts-reconfig yes\n\n# 有时 Redis 服务器有某些命令，这些命令是 Sentinel 正常工作所需的，重命名为不可猜测的字符串。在提供 Redis 即服务且不希望客户在管理控制台之外重新配置实例的提供商的上下文中，CONFIG 和 SLAVEOF 通常就是这种情况。\n# 在这种情况下，可以告诉 Sentinel 使用不同的命令名称而不是普通的命令名称。例如，如果主“mymaster”和关联的副本将“CONFIG”都重命名为“GUESSME”，我可以使用：\n# SENTINEL rename-command mymaster CONFIG GUESSME\n# 设置好这样的配置后，每次 Sentinel 使用 CONFIG 时，它都会使用 GUESSME。请注意，实际上并不需要尊重命令大小写，因此在上面的示例中编写“config guessme”是相同的。\n# 撤销上面的设置\n# SENTINEL rename-command mymaster CONFIG CONFIG\n\n')])]),n._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[n._v("1")]),e("br"),e("span",{staticClass:"line-number"},[n._v("2")]),e("br"),e("span",{staticClass:"line-number"},[n._v("3")]),e("br"),e("span",{staticClass:"line-number"},[n._v("4")]),e("br"),e("span",{staticClass:"line-number"},[n._v("5")]),e("br"),e("span",{staticClass:"line-number"},[n._v("6")]),e("br"),e("span",{staticClass:"line-number"},[n._v("7")]),e("br"),e("span",{staticClass:"line-number"},[n._v("8")]),e("br"),e("span",{staticClass:"line-number"},[n._v("9")]),e("br"),e("span",{staticClass:"line-number"},[n._v("10")]),e("br"),e("span",{staticClass:"line-number"},[n._v("11")]),e("br"),e("span",{staticClass:"line-number"},[n._v("12")]),e("br"),e("span",{staticClass:"line-number"},[n._v("13")]),e("br"),e("span",{staticClass:"line-number"},[n._v("14")]),e("br"),e("span",{staticClass:"line-number"},[n._v("15")]),e("br"),e("span",{staticClass:"line-number"},[n._v("16")]),e("br"),e("span",{staticClass:"line-number"},[n._v("17")]),e("br"),e("span",{staticClass:"line-number"},[n._v("18")]),e("br"),e("span",{staticClass:"line-number"},[n._v("19")]),e("br"),e("span",{staticClass:"line-number"},[n._v("20")]),e("br"),e("span",{staticClass:"line-number"},[n._v("21")]),e("br"),e("span",{staticClass:"line-number"},[n._v("22")]),e("br"),e("span",{staticClass:"line-number"},[n._v("23")]),e("br"),e("span",{staticClass:"line-number"},[n._v("24")]),e("br"),e("span",{staticClass:"line-number"},[n._v("25")]),e("br"),e("span",{staticClass:"line-number"},[n._v("26")]),e("br"),e("span",{staticClass:"line-number"},[n._v("27")]),e("br"),e("span",{staticClass:"line-number"},[n._v("28")]),e("br"),e("span",{staticClass:"line-number"},[n._v("29")]),e("br"),e("span",{staticClass:"line-number"},[n._v("30")]),e("br"),e("span",{staticClass:"line-number"},[n._v("31")]),e("br"),e("span",{staticClass:"line-number"},[n._v("32")]),e("br"),e("span",{staticClass:"line-number"},[n._v("33")]),e("br"),e("span",{staticClass:"line-number"},[n._v("34")]),e("br"),e("span",{staticClass:"line-number"},[n._v("35")]),e("br"),e("span",{staticClass:"line-number"},[n._v("36")]),e("br"),e("span",{staticClass:"line-number"},[n._v("37")]),e("br"),e("span",{staticClass:"line-number"},[n._v("38")]),e("br"),e("span",{staticClass:"line-number"},[n._v("39")]),e("br"),e("span",{staticClass:"line-number"},[n._v("40")]),e("br"),e("span",{staticClass:"line-number"},[n._v("41")]),e("br"),e("span",{staticClass:"line-number"},[n._v("42")]),e("br"),e("span",{staticClass:"line-number"},[n._v("43")]),e("br"),e("span",{staticClass:"line-number"},[n._v("44")]),e("br"),e("span",{staticClass:"line-number"},[n._v("45")]),e("br"),e("span",{staticClass:"line-number"},[n._v("46")]),e("br"),e("span",{staticClass:"line-number"},[n._v("47")]),e("br"),e("span",{staticClass:"line-number"},[n._v("48")]),e("br"),e("span",{staticClass:"line-number"},[n._v("49")]),e("br"),e("span",{staticClass:"line-number"},[n._v("50")]),e("br"),e("span",{staticClass:"line-number"},[n._v("51")]),e("br"),e("span",{staticClass:"line-number"},[n._v("52")]),e("br"),e("span",{staticClass:"line-number"},[n._v("53")]),e("br"),e("span",{staticClass:"line-number"},[n._v("54")]),e("br"),e("span",{staticClass:"line-number"},[n._v("55")]),e("br"),e("span",{staticClass:"line-number"},[n._v("56")]),e("br"),e("span",{staticClass:"line-number"},[n._v("57")]),e("br"),e("span",{staticClass:"line-number"},[n._v("58")]),e("br"),e("span",{staticClass:"line-number"},[n._v("59")]),e("br"),e("span",{staticClass:"line-number"},[n._v("60")]),e("br"),e("span",{staticClass:"line-number"},[n._v("61")]),e("br"),e("span",{staticClass:"line-number"},[n._v("62")]),e("br"),e("span",{staticClass:"line-number"},[n._v("63")]),e("br"),e("span",{staticClass:"line-number"},[n._v("64")]),e("br"),e("span",{staticClass:"line-number"},[n._v("65")]),e("br"),e("span",{staticClass:"line-number"},[n._v("66")]),e("br"),e("span",{staticClass:"line-number"},[n._v("67")]),e("br"),e("span",{staticClass:"line-number"},[n._v("68")]),e("br"),e("span",{staticClass:"line-number"},[n._v("69")]),e("br"),e("span",{staticClass:"line-number"},[n._v("70")]),e("br"),e("span",{staticClass:"line-number"},[n._v("71")]),e("br"),e("span",{staticClass:"line-number"},[n._v("72")]),e("br"),e("span",{staticClass:"line-number"},[n._v("73")]),e("br"),e("span",{staticClass:"line-number"},[n._v("74")]),e("br"),e("span",{staticClass:"line-number"},[n._v("75")]),e("br"),e("span",{staticClass:"line-number"},[n._v("76")]),e("br"),e("span",{staticClass:"line-number"},[n._v("77")]),e("br"),e("span",{staticClass:"line-number"},[n._v("78")]),e("br"),e("span",{staticClass:"line-number"},[n._v("79")]),e("br"),e("span",{staticClass:"line-number"},[n._v("80")]),e("br"),e("span",{staticClass:"line-number"},[n._v("81")]),e("br"),e("span",{staticClass:"line-number"},[n._v("82")]),e("br")])]),e("HideArticle")],1)}),[],!1,null,null,null);s.default=t.exports}}]);